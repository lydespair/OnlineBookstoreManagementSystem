<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="css/css.css" />
    <title>听雨书屋</title>
    <link rel="shortcut icon" href="img/mihuyo.ico">
</head>

<body>
    <div class="top">
        <div class="to">
            <p>网罗天下图书 传承中华文明</p>
            <ul>
                <li><a href="gouwu.html">购物车</a></li>
                <li><a href="userself.html">个人主页</a></li>
                <!--                <li><a href="zuce.html">注册</a></li>-->
                <!--                <li><a href="denglu.html">登陆</a></li>-->
            </ul>
        </div>
        <div class="clearit"></div>
    </div>

    <div class="lg">
        <div class="to">
            <div class="logo"><img src="images/logo.jpg" /></div>
            <div class="sou"><input name="" type="text" />
                <p><a href="#">搜索</a></p>
            </div>
        </div>
        <div class="clearit"></div>
    </div>

<!--    <div class="dao">-->
<!--        <ul>-->
<!--            <li><a href="index.html">首页</a></li>-->
<!--            <li><a href="shudain.html">书店区</a></li>-->
<!--            <li><a href="shutan.html">书摊区</a></li>-->
<!--            <li><a href="xinshu.html">新书</a></li>-->
<!--            <li><a href="zixun.html">资讯</a></li>-->
<!--        </ul>-->
<!--    </div>-->
    <div class="nav" style=" background:#ffffff">
        <div class="da">

            <div class="hao">
                <h2>购物车</h2>
                <div class="total_count">全部商品<em>2</em>件</div>
                <ul class="cart_list_th clearfix">
                    <li class="col01">商品名称</li>
                    <li class="col02">商品单位</li>
                    <li class="col03">商品价格</li>
                    <li class="col04">数量</li>
                    <li class="col05">小计</li>
                    <li class="col06">操作</li>
                </ul>
                <ul class="cart_list_td clearfix">
                    <li class="col01"><input type="checkbox" name="" checked=""></li>
                    <li class="col02"><img src="images/a4.jpg"></li>
                    <li class="col03">图像<br><em>198.00元</em></li>
                    <li class="col04">1本</li>
                    <li class="col05">198.00元</li>
                    <li class="col06">
                        <div class="num_add">
                            <a href="javascript:;" class="add fl">+</a>
                            <input type="text" class="num_show fl" value="1">	
                            <a href="javascript:;" class="minus fl">-</a>	
                        </div>
                    </li>
                    <li class="col07">198.00元</li>
                    <li class="col08"><a href="javascript:;">删除</a></li>
                </ul>
                <ul class="cart_list_td clearfix">
                    <li class="col01"><input type="checkbox" name="" checked=""></li>
                    <li class="col02"><img src="images/a1.jpg"></li>
                    <li class="col03">现代美国的起源<br><em>168.00元</em></li>
                    <li class="col04">1本</li>
                    <li class="col05">168.00元</li>
                    <li class="col06">
                        <div class="num_add">
                            <a href="javascript:;" class="add fl">+</a>
                            <input type="text" class="num_show fl" value="1">	
                            <a href="javascript:;" class="minus fl">-</a>	
                        </div>
                    </li>
                    <li class="col07">168.00元</li>
                    <li class="col08"><a href="javascript:;">删除</a></li>
                </ul>
                <ul class="settlements">
                    <li class="col01"><input type="checkbox" name="" checked=""></li>
                    <li class="col02">全选</li>
                    <li class="col03">合计(不含运费)：<span>¥</span><em>366.00</em><br>共计<b>2</b>件商品</li>
                    <li class="col04"><a href="pay.html">去结算</a></li>
                </ul>
            </div>




            <br>
        </div>

        <div class="foot">电子书店</div>
    </div>
<script>

    // 计算小计和总计
    function updateSubtotal() {
        var rows = document.querySelectorAll('.item-row');
        var total = 0;
        for (var i = 0; i < rows.length; i++) {
            var row = rows[i];
            var price = parseFloat(row.querySelector('td:nth-child(3)').textContent);
            var quantity = parseInt(row.querySelector('input[name="quantity[]"]').value);
            var subtotal = price * quantity;
            row.querySelector('.subtotal').textContent = subtotal.toFixed(2);
            total += subtotal;
        }
        document.querySelector('#total').textContent = total.toFixed(2);
    }

    // 删除商品
    function deleteItem() {
        var row = this.parentNode;
        row.parentNode.removeChild(row);
        updateSubtotal();
    }

    // 添加商品
    function addItem() {
        var table = document.querySelector('table');
        var row = table.insertRow(-1);
        row.classList.add('item-row');
        row.dataset.id = Date.now(); // 生成一个随机ID
        row.innerHTML = `
				<td class="check"><input type="checkbox" name="item[]" value="${row.dataset.id}"></td>
				<td><input type="text" name="name[]"></td>
				<td><input type="number" name="price[]" step="0.01"></td>
				<td><input type="number" name="quantity[]" value="1"></td>
				<td class="subtotal">0.00</td>
				<td class="delete">X</td>
			`;
        row.querySelector('.delete').addEventListener('click', deleteItem);
        row.querySelector('input[name="quantity[]"]').addEventListener('input', updateSubtotal);
        row.querySelector('input[name="price[]"]').addEventListener('input', updateSubtotal);
    }

    // 结算选中的商品
    function checkout() {
        var items = document.querySelectorAll('input[name="item[]"]:checked');
        var ids = [];
        for (var i = 0; i < items.length; i++) {
            ids.push(items[i].value);
        }
        if (ids.length > 0) {
            window.location.href = 'checkout.php?ids=' + ids.join(',');
        } else {
            alert('请选择要结算的商品');
        }
    }

    // 绑定事件
    var deleteButtons = document.querySelectorAll('.delete');
    for (var i = 0; i < deleteButtons.length; i++) {
        deleteButtons[i].addEventListener('click', deleteItem);
    }
    var addBtn = document.querySelector('#add');
    addBtn.addEventListener('click', addItem);
    var quantityInputs = document.querySelectorAll('input[name="quantity[]"]');
    for (var i = 0; i < quantityInputs.length; i++) {
        quantityInputs[i].addEventListener('input', updateSubtotal);
    }
    var priceInputs = document.querySelectorAll('input[name="price[]"]');
    for (var i = 0; i < priceInputs.length; i++) {
        priceInputs[i].addEventListener('input', updateSubtotal);
    }
</script>
</body>


</html>