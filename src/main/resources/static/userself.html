<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>网上书店系统/我的主页</title>
    <link rel="shortcut icon" href="img/mihuyo.ico">
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"
            integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="//unpkg.com/vue@2/dist/vue.js"></script>
    <script src="//unpkg.com/element-ui@2.15.14/lib/index.js"></script>
</head>
<body>

<div id="app">
    <el-header style="font-size: 12px">
        <el-row type="flex" justify="space-around" style="align-items: center; text-align: right">
            <el-col :span="16"></el-col>
            <el-col :span="2">
                <el-dropdown>
                    <i class="el-icon-more-outline" style="margin-right: 15px"></i>
                    <el-dropdown-menu v-slot="dropdown">
                        <el-dropdown-item><i class="el-icon-user-solid"></i><a href="userself.html"
                                                                               onclick="topggleForm();"
                                                                               style="text-decoration: none;color:#808080">个人中心</a>
                        </el-dropdown-item>
                        <el-dropdown-item><i class="el-icon-shopping-cart-2"></i><a href="vuehtml/shoppingcart.html"
                                                                                    onclick="topggleForm();"
                                                                                    style="text-decoration: none;color:#808080">我的购物车</a>
                        </el-dropdown-item>
                        <el-dropdown-item><i class="el-icon-shopping-bag-2"></i><a href="vuehtml/myorder.html"
                                                                                   onclick="topggleForm();"
                                                                                   style="text-decoration: none;color:#808080">我的订单</a>
                        </el-dropdown-item>
                        <el-dropdown-item><i class="el-icon-switch-button"></i><a href="login.html"
                                                                                  onclick="topggleForm();"
                                                                                  style="text-decoration: none;color:#808080">退出登录</a>
                        </el-dropdown-item>
                    </el-dropdown-menu>
                </el-dropdown>
            </el-col>

            <span>金芒火炙蟹棒卷</span>
            <el-avatar shape="circle" :size="45" :fit="'fill'"
                       src="https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"></el-avatar>
        </el-row>
    </el-header>
    <el-main>
        <el-breadcrumb separator-class="el-icon-arrow-right">
            <el-breadcrumb-item :to="{ path: '/' }"><a href="vuehtml/oldindex.html"
                                                       style="text-decoration: none;">首页</a></el-breadcrumb-item>
            <el-breadcrumb-item><i class="el-icon-user-solid"></i>个人中心</el-breadcrumb-item>
        </el-breadcrumb>
        <el-container>
            <el-aside>
                <h1>我的头像</h1>
                <div class="block">
                    <el-avatar shape="square" :size="250" :src="squareUrl"></el-avatar>
                    <h2>用户名</h2>
                    <h5>xxxxx@qq.com</h5>
                    <el-divider><i class="el-icon-date"></i></el-divider>
                    <el-calendar v-model="value">
                    </el-calendar>


                </div>
            </el-aside>
            <el-main>
                <el-divider content-position="right"><i class="el-icon-tickets"></i></el-divider>
                <h3> 我的信息</h3>
                <template>
                    <el-descriptions class="margin-top" title="" :column="3" :size="size" border>
                        <template slot="extra">
                            <el-button type="primary" size="small" @click="getList">修改</el-button>
                            <el-dialog title="个人信息" :visible.sync="dialogVisible" width="30%">
                                <el-form ref="form" :model="form" label-width="80px">
                                    <el-form-item label="用户名">
                                        <el-input v-model="form.name"></el-input>
                                    </el-form-item>
                                    <el-form-item label="手机号">
                                        <el-input v-model="form.tel"></el-input>
                                    </el-form-item>
                                    <el-form-item label="居住地">
                                        <el-input v-model="form.address"></el-input>
                                    </el-form-item>
                                    <el-form-item label="邮箱">
                                        <el-input v-model="form.email"></el-input>
                                    </el-form-item>
                                </el-form>
                                <span slot="footer" class="dialog-footer">
                                    <el-button type="primary" @click="update">确 定 修 改</el-button>
                                    <el-button @click="dialogVisible = false">取 消</el-button>
                                 </span>
                            </el-dialog>
                        </template>
                        <el-descriptions-item>
                            <template slot="label">
                                <i class="el-icon-user"></i>
                                用户名
                            </template>
                            金芒火炙蟹棒卷
                        </el-descriptions-item>
                        <el-descriptions-item>
                            <template slot="label">
                                <i class="el-icon-mobile-phone"></i>
                                手机号
                            </template>
                            18100000000
                        </el-descriptions-item>
                        <el-descriptions-item>
                            <template slot="label">
                                <i class="el-icon-location-outline"></i>
                                居住地
                            </template>
                            武汉市
                        </el-descriptions-item>
                        <el-descriptions-item>
                            <template slot="label">
                                <i class="el-icon-tickets"></i>
                                备注
                            </template>
                            <el-tag size="small">学校</el-tag>
                        </el-descriptions-item>
                        <el-descriptions-item>
                            <template slot="label">
                                <i class="el-icon-office-building"></i>
                                邮箱
                            </template>
                            湖北省武汉市江夏区藏龙大道 1188 号
                        </el-descriptions-item>
                    </el-descriptions>
                </template>

                <br>
                <el-divider content-position="right"><i class="el-icon-edit"></i></el-divider>
                <h3>我的留言</h3>
                <div style="margin: 20px 0;"></div>
                <el-input
                        type="textarea"
                        placeholder="请输入内容"
                        v-model="textarea"
                        maxlength="30"
                        show-word-limit
                >
                </el-input>


            </el-main>

        </el-container>

    </el-main>
</div>

<script>
    const app = new Vue({
        el: '#app',
        data() {
            return {

                dialogVisible: false,
                form: {
                    name: '',
                    tel:'',
                    address: '',
                    email: ''
                },

                squareUrl: "https://imgsa.baidu.com/forum/pic/item/a260fd246b600c33d091fa30144c510fd8f9a165.jpg",
                value: new Date(),
                textarea: '',
                size: '',
                fits: ['fill', 'contain', 'cover', 'none', 'scale-down'],
                url: 'https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg',
            }
        },
        methods: {
            topggleForm() {
                var container = document.querySelector('.container');
                container.classList.toggle('active');
            },
            getList() {
                this.dialogVisible = true
                const user = sessionStorage.getItem('user');
                var cur = JSON.parse(user);

                this.form.name = cur.userName
                this.form.tel = cur.tel
                this.form.address = cur.address
                this.form.email = cur.email
                // const author = JSON.parse(localStorage.getItem('jwtToken'))
                // console.log(author)
            },
            update() {
                this.dialogVisible = false
                $.ajax({
                    url: "/users",
                    //this.name为cookie的内容
                    type: "put",
                    headers: {
                        Authorization: localStorage.getItem('token')
                    },
                    // data表示发送的数据
                    data: JSON.stringify({cur}),
                    // 定义发送请求的数据格式为JSON字符串
                    contentType: "application/json;charset=UTF-8",
                    //定义回调响应的数据格式为JSON字符串,该属性可以省略
                    dataType: "json",
                    //成功响应的结果
                    success: function (data) {
                        console.log(data);
                        if (data.code !== 0) {
                            document.cookie = "userData=data.data";
                            console.log(document.cookie);
                            location.href = "index.html";
                        } else {
                            alert("用户名或密码错误")
                        }
                    }
                })
            }

        }
    })


</script>

<style>
    @import url("//unpkg.com/element-ui@2.15.14/lib/theme-chalk/index.css");

    body {
        background-size: cover;
    }

    .app {
        background-color: #99a9bf;
    }

    .el-header {
        background-color: #8c222c;
        color: #B3C0D1;
        line-height: 60px;
    }

    .el-aside {
        color: #333;
    }

    .el-footer {
        background-color: #B3C0D1;
        color: #333;
        line-height: 60px;
    }
</style>

</body>
</html>